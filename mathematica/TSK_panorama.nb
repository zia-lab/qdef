(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96511,       2189]
NotebookOptionsPosition[     93426,       2126]
NotebookOutlinePosition[     93823,       2142]
CellTagsIndexPosition[     93780,       2139]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Multiplet Structure of Transition Metal Ions in a Crystal Field with Cubic \
Symmetry\
\>", "Title",
 CellChangeTimes->{{3.855599563130542*^9, 3.855599575998886*^9}, {
  3.855600227653479*^9, 3.855600238630362*^9}},
 TextAlignment->Center,ExpressionUUID->"c79aa525-ceb9-4d2a-afbf-c1054b810dc9"],

Cell["Mar - 06 2022 - 03 - 06 19 : 04 : 03", "Text",
 CellChangeTimes->{{3.855600243861137*^9, 3.855600246228243*^9}},
 TextAlignment->Center,ExpressionUUID->"62bfb0f1-861d-435a-9a3e-080963a2cdf2"],

Cell[CellGroupData[{

Cell["Data Loader", "Section",
 CellChangeTimes->{{3.85559961702792*^9, 
  3.855599624430612*^9}},ExpressionUUID->"e6684225-0fee-479e-8f3f-\
965e2d5c5f54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cowandata", "=", 
    RowBox[{
     RowBox[{"Import", "[", "\"\<brik_and_ma_from_cowan.xlsx\>\"", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"h5fname", "=", "\"\<tsk_hypercube.h5\>\""}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h5fname", "=", "\"\</Users/juan/Temp/tsk_hypercube.h5\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headers", "=", 
   RowBox[{"cowandata", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cowandata", "=", 
   RowBox[{"cowandata", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evtocm", "=", "8065.544290"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cowanA", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "->", 
       RowBox[{"Association", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<d^n\>\"", "->", 
           RowBox[{"Round", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<B\>\"", "->", 
           RowBox[{"Round", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<C\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<\[Zeta]\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "11", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<C/B\>\"", "->", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "7", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], ",", "0.1"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], "&"}], "/@", "cowandata"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tskkeys", "=", 
   RowBox[{"Import", "[", "h5fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]soB", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"h5fname", ",", "\"\</params/gammas_B\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DqsoB", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"h5fname", ",", "\"\</params/Dqs_B\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Zeta]soB", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"h5fname", ",", "\"\</params/zetas_B\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keyTemplate", "=", 
   RowBox[{
   "StringTemplate", "[", "\"\</`num_electrons`/`gamma_idx`/`zeta_idx`\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Nearest", "::", "neard"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Part", "::", "partw"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shellToatoms", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<3d\>\"", "->", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"\"\<Sc Ti V Cr Mn Fe Co Ni Cu Zn\>\"", ",", "\"\< \>\""}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<4d\>\"", "->", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"\"\<Y Zr Nb Mo Tc Ru Rh Pd Ag Cd\>\"", ",", "\"\< \>\""}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<5d\>\"", "->", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"\"\<Lu Hf Ta W Re Os Ir Pt Au Hg\>\"", ",", "\"\< \>\""}], 
       "]"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evtocm", "=", "8065.544290"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855517488012105*^9, 3.855517488173905*^9}, {
  3.85559962953296*^9, 3.855599641401897*^9}, {3.8555996998764753`*^9, 
  3.855599700035285*^9}, {3.855600072495099*^9, 3.855600144185215*^9}, {
  3.855600336303761*^9, 3.855600336478876*^9}, {3.855849715879121*^9, 
  3.855849716194021*^9}, {3.855851590418747*^9, 3.855851591236487*^9}, {
  3.8559007439686832`*^9, 3.855900751028824*^9}, {3.855901158463994*^9, 
  3.8559011594173603`*^9}, {3.855901452525777*^9, 3.855901469912356*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"655ccd46-a513-469a-aa0a-cb3e9a034e4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["E(\[Zeta]/B, C/B, Dq/B)", "Section",
 CellChangeTimes->{{3.855516216116012*^9, 3.855516219587758*^9}, {
  3.855599671017868*^9, 
  3.855599683475931*^9}},ExpressionUUID->"5cde32bc-e3da-4aa9-bf5b-\
2537a5eeed37"],

Cell["\<\
Here one may see the energies of the different eigenstates under a crystal \
field with cubic symmetry as a function of \[Zeta]/B, C/B, Dq/B.\
\>", "Text",
 CellChangeTimes->{{3.855599757995062*^9, 3.855599793040843*^9}, {
  3.8555998469811296`*^9, 
  3.8555998490509777`*^9}},ExpressionUUID->"8331797c-55c7-4105-a737-\
c515f29b041e"],

Cell[CellGroupData[{

Cell["Without multiplicities", "Subsection",
 CellChangeTimes->{{3.855672181898313*^9, 
  3.85567219089487*^9}},ExpressionUUID->"40c981f6-fca6-4325-99ac-\
84fee0b59c3c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]oB", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"\[Gamma]soB", ",", "\[Gamma]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Zeta]oB", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"\[Zeta]soB", ",", "\[Zeta]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]idx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Gamma]soB", ",", "\[Gamma]oB"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Zeta]idx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Zeta]soB", ",", "\[Zeta]oB"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"key", "=", 
      RowBox[{"keyTemplate", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<num_electrons\>\"", "->", "numElectrons"}], ",", 
         RowBox[{"\"\<gamma_idx\>\"", "->", "\[Gamma]idx"}], ",", 
         RowBox[{"\"\<zeta_idx\>\"", "->", "\[Zeta]idx"}]}], "|>"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"h5fname", ",", "key"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"minima", "=", 
      RowBox[{"Min", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"data", "-", "minima"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"DqsoB", ",", "#"}], "}"}], "]"}], "&"}], "/@", "data"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Dq/B\>\"", ",", "\"\<E/B\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "->", 
        RowBox[{"Directive", "[", "16", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "->", "800"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Joined", "->", "joined"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Thick", ",", "Blue"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "6"}], ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Erange"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Erange", ",", "50"}], "}"}], ",", "1", ",", "399", ",", 
           "1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Zeta]", ",", "0"}], "}"}], ",", "0", ",", 
           RowBox[{"Max", "[", "\[Zeta]soB", "]"}], ",", "0.01"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Gamma]", ",", "4."}], "}"}], ",", 
           RowBox[{"Min", "[", "\[Gamma]soB", "]"}], ",", 
           RowBox[{"Max", "[", "\[Gamma]soB", "]"}], ",", "0.01"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"numElectrons", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", 
             ",", "8", ",", "9"}], "}"}], ",", 
           RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"joined", ",", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.855508432876552*^9, 3.85550843760769*^9}, {
   3.855508476524905*^9, 3.855508567768532*^9}, {3.855508599001041*^9, 
   3.8555087517166348`*^9}, {3.8555087897706537`*^9, 
   3.8555090988944073`*^9}, {3.855509154058384*^9, 3.855509156017283*^9}, {
   3.855509190049982*^9, 3.855509205226368*^9}, {3.855509243032156*^9, 
   3.855509245406352*^9}, {3.8555097499335623`*^9, 3.8555097533734283`*^9}, {
   3.8555151481401043`*^9, 3.8555151482620687`*^9}, {3.8555157831126757`*^9, 
   3.855515790028037*^9}, {3.855515867357132*^9, 3.855515885563838*^9}, {
   3.855519263104723*^9, 3.8555192653259783`*^9}, {3.8555803881282673`*^9, 
   3.855580388608905*^9}, 3.855599798949748*^9, {3.855668335969141*^9, 
   3.85566833620074*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"db8a4c65-2f26-42ca-a132-4d17503ca3bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["With multiplicities", "Subsection",
 CellChangeTimes->{{3.855672181898313*^9, 
  3.855672198199771*^9}},ExpressionUUID->"e09b2eaa-bc00-427e-8879-\
12c33293c24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DqsoB", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"h5fname", ",", "\"\</params/Dqs_B\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.855851725328886*^9, 3.855851753946024*^9}, {
  3.855900771377369*^9, 3.855900772498046*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"55ea2be0-835e-43d3-8b36-51d893f097c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]oB", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"\[Gamma]soB", ",", "\[Gamma]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Zeta]oB", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"\[Zeta]soB", ",", "\[Zeta]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]idx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Gamma]soB", ",", "\[Gamma]oB"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Zeta]idx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Zeta]soB", ",", "\[Zeta]oB"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"key", "=", 
      RowBox[{"keyTemplate", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<num_electrons\>\"", "->", "numElectrons"}], ",", 
         RowBox[{"\"\<gamma_idx\>\"", "->", "\[Gamma]idx"}], ",", 
         RowBox[{"\"\<zeta_idx\>\"", "->", "\[Zeta]idx"}]}], "|>"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"h5fname", ",", "key"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"minima", "=", 
      RowBox[{"Min", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"data", "-", "minima"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"DqsoB", ",", "#"}], "}"}], "]"}], "&"}], "/@", "data"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"tdata", "=", 
      RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multidata", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multidata", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dq", "=", 
           RowBox[{"datum", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eivals", "=", 
           RowBox[{"Chop", "[", 
            RowBox[{"Last", "/@", "datum"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eivals", "=", 
           RowBox[{"Round", "[", 
            RowBox[{"eivals", ",", "0.001"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"uniqueEigenvals", "=", 
           RowBox[{"DeleteDuplicates", "[", "eivals", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Dq", ",", "eival", ",", 
              RowBox[{"Count", "[", 
               RowBox[{"eivals", ",", "eival"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"eival", ",", "uniqueEigenvals"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ")"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"datum", ",", "tdata"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"multidata", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"multidata", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multis", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Last", "/@", "multidata"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"multidata", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "count"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"count", ",", "multis"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Dq/B\>\"", ",", "\"\<E/B\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "->", "1300"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "->", "multis"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"16", ",", "Thick"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "->", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Superscript", "[", 
             RowBox[{"\"\<d\>\"", ",", "numElectrons"}], "]"}], ",", 
            "\"\< | \[Zeta]/B = \>\"", ",", "\[Zeta]oB", ",", 
            "\"\< | C/B = \>\"", ",", "\[Gamma]oB"}], "}"}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", "\"\<Title\>\""}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Dqrange"}], ",", "Dqrange"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "Erange"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Erange", ",", "50"}], "}"}], ",", "1", ",", "399", ",", 
           "1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Zeta]", ",", "0"}], "}"}], ",", "0", ",", 
           RowBox[{"Max", "[", "\[Zeta]soB", "]"}], ",", "0.01"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Gamma]", ",", "4.4"}], "}"}], ",", 
           RowBox[{"Min", "[", "\[Gamma]soB", "]"}], ",", 
           RowBox[{"Max", "[", "\[Gamma]soB", "]"}], ",", "0.01"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dqrange", ",", "4."}], "}"}], ",", "1", ",", "6", ",", 
           "0.1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"numElectrons", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", 
             ",", "8", ",", "9"}], "}"}], ",", 
           RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.855508432876552*^9, 3.85550843760769*^9}, {
   3.855508476524905*^9, 3.855508567768532*^9}, {3.855508599001041*^9, 
   3.8555087517166348`*^9}, {3.8555087897706537`*^9, 
   3.8555090988944073`*^9}, {3.855509154058384*^9, 3.855509156017283*^9}, {
   3.855509190049982*^9, 3.855509205226368*^9}, {3.855509243032156*^9, 
   3.855509245406352*^9}, {3.8555097499335623`*^9, 3.8555097533734283`*^9}, {
   3.8555151481401043`*^9, 3.8555151482620687`*^9}, {3.8555157831126757`*^9, 
   3.855515790028037*^9}, {3.855515867357132*^9, 3.855515885563838*^9}, {
   3.855519263104723*^9, 3.8555192653259783`*^9}, {3.8555803881282673`*^9, 
   3.855580388608905*^9}, 3.855599798949748*^9, {3.855668335969141*^9, 
   3.85566833620074*^9}, {3.8556698310548077`*^9, 3.8556698549423637`*^9}, {
   3.8556710978476553`*^9, 3.8556710988018084`*^9}, {3.855672214276178*^9, 
   3.855672223971445*^9}, 3.855851740778578*^9, {3.855901023375017*^9, 
   3.855901064323247*^9}, {3.855901438246291*^9, 3.8559014414508667`*^9}, 
   3.855911070940228*^9, {3.8559264454754667`*^9, 3.855926499960785*^9}, {
   3.855926530938369*^9, 3.8559266042181177`*^9}, {3.85592664706363*^9, 
   3.855926656178618*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"e2d4f54f-be54-4725-a945-1a4ba8601310"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Dqrange$$ = 4., $CellContext`Erange$$ = 
    50, $CellContext`numElectrons$$ = 5, $CellContext`\[Gamma]$$ = 
    4.4, $CellContext`\[Zeta]$$ = 2.45, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`Erange$$], 50}, 1, 399, 1}, {{
       Hold[$CellContext`\[Zeta]$$], 0}, 0, 11., 0.01}, {{
       Hold[$CellContext`\[Gamma]$$], 4.4}, 3.41, 4.51, 0.01}, {{
       Hold[$CellContext`Dqrange$$], 4.}, 1, 6, 0.1}, {{
       Hold[$CellContext`numElectrons$$], 2}, {1, 2, 3, 4, 5, 6, 7, 8, 9}}, {
      Hold[
       Row[{
         Column[{
           Manipulate`Place[1], 
           Manipulate`Place[2], 
           Manipulate`Place[3], 
           Manipulate`Place[4], 
           Manipulate`Place[5]}]}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {1300., {399., 372.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`Dqrange$$ = 4., $CellContext`Erange$$ = 
        50, $CellContext`numElectrons$$ = 2, $CellContext`\[Gamma]$$ = 
        4.4, $CellContext`\[Zeta]$$ = 0}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`\[Gamma]oB = Part[
          Nearest[$CellContext`\[Gamma]soB, $CellContext`\[Gamma]$$], 
          1]; $CellContext`\[Zeta]oB = Part[
          Nearest[$CellContext`\[Zeta]soB, $CellContext`\[Zeta]$$], 
          1]; $CellContext`\[Gamma]idx = Part[
           Position[$CellContext`\[Gamma]soB, $CellContext`\[Gamma]oB], 1, 1] - 
         1; $CellContext`\[Zeta]idx = Part[
           Position[$CellContext`\[Zeta]soB, $CellContext`\[Zeta]oB], 1, 1] - 
         1; $CellContext`key = $CellContext`keyTemplate[<|
          "num_electrons" -> $CellContext`numElectrons$$, 
           "gamma_idx" -> $CellContext`\[Gamma]idx, 
           "zeta_idx" -> $CellContext`\[Zeta]idx|>]; $CellContext`data = 
        Import[$CellContext`h5fname, $CellContext`key]; $CellContext`minima = 
        Map[Min, $CellContext`data]; $CellContext`data = $CellContext`data - \
$CellContext`minima; $CellContext`data = 
        Transpose[$CellContext`data]; $CellContext`data = 
        Map[Transpose[{$CellContext`DqsoB, #}]& , $CellContext`data]; \
$CellContext`tdata = 
        Transpose[$CellContext`data]; $CellContext`multidata = <||>; \
$CellContext`multidata = 
        Table[$CellContext`Dq = 
           Part[$CellContext`datum, 1, 1]; $CellContext`eivals = Chop[
             Map[Last, $CellContext`datum]]; $CellContext`eivals = 
           Round[$CellContext`eivals, 0.001]; $CellContext`uniqueEigenvals = 
           DeleteDuplicates[$CellContext`eivals]; 
          Table[{$CellContext`Dq, $CellContext`eival, 
             
             Count[$CellContext`eivals, $CellContext`eival]}, \
{$CellContext`eival, $CellContext`uniqueEigenvals}], {$CellContext`datum, \
$CellContext`tdata}]; $CellContext`multidata = 
        Flatten[$CellContext`multidata, 1]; $CellContext`multis = Sort[
          DeleteDuplicates[
           Map[Last, $CellContext`multidata]]]; $CellContext`data = Table[
          Map[{
            Part[#, 1], 
            Part[#, 2]}& , 
           
           Select[$CellContext`multidata, 
            Part[#, 3] == $CellContext`count& ]], {$CellContext`count, \
$CellContext`multis}]; 
       ListPlot[$CellContext`data, Frame -> True, 
         FrameLabel -> {"Dq/B", "E/B"}, ImageSize -> 1300, AspectRatio -> 1/2,
          PlotStyle -> Automatic, PlotLegends -> $CellContext`multis, 
         FrameStyle -> Directive[16, Thick], PlotLabel -> Row[{
            Superscript["d", $CellContext`numElectrons$$], 
            " | \[Zeta]/B = ", $CellContext`\[Zeta]oB, 
            " | C/B = ", $CellContext`\[Gamma]oB}, BaseStyle -> "Title"], 
         PlotRange -> {{-$CellContext`Dqrange$$, $CellContext`Dqrange$$}, \
{-0.5, $CellContext`Erange$$}}]), 
      "Specifications" :> {{{$CellContext`Erange$$, 50}, 1, 399, 1, 
         ControlPlacement -> 1}, {{$CellContext`\[Zeta]$$, 0}, 0, 11., 0.01, 
         ControlPlacement -> 2}, {{$CellContext`\[Gamma]$$, 4.4}, 3.41, 4.51, 
         0.01, ControlPlacement -> 3}, {{$CellContext`Dqrange$$, 4.}, 1, 6, 
         0.1, ControlPlacement -> 4}, {{$CellContext`numElectrons$$, 2}, {1, 
         2, 3, 4, 5, 6, 7, 8, 9}, ControlType -> SetterBar, ControlPlacement -> 
         5}, 
        Row[{
          Column[{
            Manipulate`Place[1], 
            Manipulate`Place[2], 
            Manipulate`Place[3], 
            Manipulate`Place[4], 
            Manipulate`Place[5]}]}]}, "Options" :> {TrackedSymbols :> True}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1344., {483., 489.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.856004400149754*^9, 3.856005795448936*^9, 3.856279624706669*^9, {
   3.856279692103797*^9, 3.856279695051859*^9}, 3.857207472368641*^9},
 CellLabel->
  "Out[823]=",ExpressionUUID->"e6e8071d-0c8d-433f-986e-1fdbb0a40fe5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"\[Zeta]soB", "[", 
   RowBox[{"[", 
    RowBox[{";;", ";;", "5"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.856001883729391*^9, 3.856001904167828*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"6c7f6544-8a56-46ef-9675-10721c4b496f"],

Cell[BoxData["23"], "Output",
 CellChangeTimes->{{3.856001886403112*^9, 3.8560019047797728`*^9}},
 CellLabel->
  "Out[199]=",ExpressionUUID->"b9cc60a3-0d03-46b9-8e1f-a19e9c701213"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.856001921535256*^9},ExpressionUUID->"980b4527-2d0a-4e37-bc1c-\
ce92813fb509"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.5`", ",", "1.`", ",", "1.5`", ",", "2.`", ",", "2.5`", ",", 
   "3.`", ",", "3.5`", ",", "4.`", ",", "4.5`", ",", "5.`", ",", "5.5`", ",", 
   "6.`", ",", "6.5`", ",", "7.`", ",", "7.5`", ",", "8.`", ",", "8.5`", ",", 
   "9.`", ",", "9.5`", ",", "10.`", ",", "10.5`", ",", "11.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.856001911903729*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"91eb6a59-c715-40ba-b6f3-36a659b34e4b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"figTemplate", "=", 
   RowBox[{
   "StringTemplate", "[", 
    "\"\</Users/juan/Temp/figs/`numElectrons`-`idx0`-`idx1`.jpg\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figs", "=", 
   RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"\[Gamma]soB", ",", "\[Gamma]oB"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Zeta]idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"\[Zeta]soB", ",", "\[Zeta]oB"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"key", "=", 
        RowBox[{"keyTemplate", "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<num_electrons\>\"", "->", "numElectrons"}], ",", 
           RowBox[{"\"\<gamma_idx\>\"", "->", "\[Gamma]idx"}], ",", 
           RowBox[{"\"\<zeta_idx\>\"", "->", "\[Zeta]idx"}]}], "|>"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"h5fname", ",", "key"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"minima", "=", 
        RowBox[{"Min", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"data", "-", "minima"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"DqsoB", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
         "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tdata", "=", 
        RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multidata", "=", 
        RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multidata", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dq", "=", 
             RowBox[{"datum", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"eivals", "=", 
             RowBox[{"Chop", "[", 
              RowBox[{"Last", "/@", "datum"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"eivals", "=", 
             RowBox[{"Round", "[", 
              RowBox[{"eivals", ",", "0.001"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"uniqueEigenvals", "=", 
             RowBox[{"DeleteDuplicates", "[", "eivals", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Dq", ",", "eival", ",", 
                RowBox[{"Count", "[", 
                 RowBox[{"eivals", ",", "eival"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"eival", ",", "uniqueEigenvals"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", ")"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"datum", ",", "tdata"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"multidata", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"multidata", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multis", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Last", "/@", "multidata"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Select", "[", 
            RowBox[{"multidata", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "==", "count"}], "&"}]}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"count", ",", "multis"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fig", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"data", ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Dq/B\>\"", ",", "\"\<E/B\>\""}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "1300"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "->", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "->", "multis"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"16", ",", "Thick"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{"Row", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Superscript", "[", 
                RowBox[{"\"\<d\>\"", ",", "numElectrons"}], "]"}], ",", 
               "\"\< | \[Zeta]/B = \>\"", ",", "\[Zeta]oB", ",", 
               "\"\< | C/B = \>\"", ",", "\[Gamma]oB"}], "}"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "\"\<Title\>\""}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "50"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{"figFname", "=", 
        RowBox[{"figTemplate", "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<numElectrons\>\"", "->", "numElectrons"}], ",", 
           RowBox[{"\"\<idx0\>\"", "->", "\[Gamma]idx"}], ",", 
           RowBox[{"\"\<idx1\>\"", "->", "\[Zeta]idx"}]}], "|>"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"figFname", ",", "fig"}], "]"}], ";"}], "\[IndentingNewLine]",
       ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"numElectrons", ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
         "8", ",", "9"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]oB", ",", 
       RowBox[{"\[Gamma]soB", "[", 
        RowBox[{"[", 
         RowBox[{";;", ";;", "5"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]oB", ",", 
       RowBox[{"\[Zeta]soB", "[", 
        RowBox[{"[", 
         RowBox[{";;", ";;", "5"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.856001402529829*^9, 3.8560015228639603`*^9}, {
  3.856001570794239*^9, 3.856001722009108*^9}, {3.8560019247912903`*^9, 
  3.856001936168891*^9}, {3.8560020459754753`*^9, 3.856002046248786*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"f33e0381-4b84-4b6f-8061-45aae966ef07"],

Cell[BoxData[
 RowBox[{"Length", "[", "figs", "]"}]], "Input",
 CellChangeTimes->{{3.856001527742066*^9, 
  3.85600152953799*^9}},ExpressionUUID->"81bcfc0b-11e2-4c53-964a-\
ace18327ca3b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Transition Metal Ions", "Section",
 CellChangeTimes->{{3.855516216116012*^9, 3.855516236266431*^9}, {
  3.855743670797504*^9, 3.855743675589999*^9}, {3.8560012604*^9, 
  3.856001262881857*^9}},ExpressionUUID->"51a2af69-5072-4a10-bf6a-\
0fc30f940320"],

Cell["\<\
Taking the HF values for free ions, here one may view an approximation of \
their energy levels under a crystal field with cubic symmetry.\
\>", "Text",
 CellChangeTimes->{{3.855599757995062*^9, 3.855599793040843*^9}, {
  3.8555998469811296`*^9, 3.8555998490509777`*^9}, {3.855599879788332*^9, 
  3.855599909890627*^9}, {3.8556004183929033`*^9, 3.855600429559429*^9}, {
  3.855929417323155*^9, 
  3.855929422779736*^9}},ExpressionUUID->"a20f7dde-bbf0-456d-b702-\
205e15b93468"],

Cell[CellGroupData[{

Cell["With Multiplicity", "Subsection",
 CellChangeTimes->{{3.856001318063246*^9, 
  3.8560013287781477`*^9}},ExpressionUUID->"f196ee70-23ea-412e-aca3-\
6478433e530f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"allMinima", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", "=", 
      RowBox[{"{", 
       RowBox[{"atom", ",", "charge"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "cowanA", "]"}], ",", "key"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<C/B\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"B", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<B\>\"", "]"}], 
            ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<\[Zeta]\>\"", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]", "=", 
          RowBox[{"\[Zeta]", "/", "B"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]oB", "=", 
          RowBox[{
           RowBox[{"Nearest", "[", 
            RowBox[{"\[Gamma]soB", ",", "\[Gamma]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]oB", "=", 
          RowBox[{
           RowBox[{"Nearest", "[", 
            RowBox[{"\[Zeta]soB", ",", "\[Zeta]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]idx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Gamma]soB", ",", "\[Gamma]oB"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]idx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Zeta]soB", ",", "\[Zeta]oB"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numElectrons", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<d^n\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tskkey", "=", 
          RowBox[{"keyTemplate", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<num_electrons\>\"", "->", "numElectrons"}], ",", 
             RowBox[{"\"\<gamma_idx\>\"", "->", "\[Gamma]idx"}], ",", 
             RowBox[{"\"\<zeta_idx\>\"", "->", "\[Zeta]idx"}]}], "|>"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"tskkeys", ",", "tskkey"}], "]"}], ",", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"data", "=", 
              RowBox[{"Import", "[", 
               RowBox[{"h5fname", ",", "tskkey"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"allMinima", ",", "tskkey"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"minima", "=", 
                 RowBox[{"allMinima", "[", "tskkey", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"minima", "=", 
                  RowBox[{"Min", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"allMinima", "[", "tskkey", "]"}], "=", "minima"}], 
                 ";"}], ")"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"data", "-", "minima"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"Transpose", "[", "data", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"DqsoB", "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                   RowBox[{"#", "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}], "]"}], "&"}], "/@",
                "data"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"rdata", "=", "data"}], ";", "\[IndentingNewLine]", 
             RowBox[{"xTicks", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ee", "/", "B"}], "*", "evtocm", "*", 
                   FractionBox["B", "evtocm"]}], ",", "ee"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ee", ",", 
                  RowBox[{"-", 
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"6", "/", "B"}], "*", "evtocm"}], ",", "0.1"}], 
                    "]"}]}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"6", "/", "B"}], "*", "evtocm"}], ",", "0.1"}], 
                   "]"}], ",", "0.1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"yTicks", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ee", "/", "B"}], "*", "evtocm", "*", 
                   FractionBox["B", "evtocm"]}], ",", 
                  RowBox[{"ee", "*", 
                   FractionBox["B", "evtocm"]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ee", ",", "0", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"10", "/", "B"}], "*", "evtocm"}], ",", "0.25"}], 
                   "]"}], ",", "0.25"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tdata", "=", 
              RowBox[{"Transpose", "[", "data", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"multidata", "=", 
              RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"multidata", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Dq", "=", 
                   RowBox[{"datum", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eivals", "=", 
                   RowBox[{"Chop", "[", 
                    RowBox[{"Last", "/@", "datum"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eivals", "=", 
                   RowBox[{"Round", "[", 
                    RowBox[{"eivals", ",", "0.001"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"uniqueEigenvals", "=", 
                   RowBox[{"DeleteDuplicates", "[", "eivals", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Dq", ",", "eival", ",", 
                    RowBox[{"Count", "[", 
                    RowBox[{"eivals", ",", "eival"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"eival", ",", "uniqueEigenvals"}], "}"}]}], 
                   "]"}]}], "\[IndentingNewLine]", ")"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"datum", ",", "tdata"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"multidata", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"multidata", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"multis", "=", 
              RowBox[{"Sort", "[", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Last", "/@", "multidata"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Select", "[", 
                  RowBox[{"multidata", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "count"}], "&"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"count", ",", "multis"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]oB", ",", "\[Zeta]oB"}], "}"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"plotLabel", "=", 
              RowBox[{"Row", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Superscript", "[", 
                   RowBox[{"atom", ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", "charge", "]"}], "<>", 
                    "\"\<+\>\""}]}], "]"}], ",", "\"\< | \>\"", ",", 
                  RowBox[{"Superscript", "[", 
                   RowBox[{"shell", ",", "numElectrons"}], "]"}], ",", 
                  RowBox[{"\"\< | B=\>\"", "<>", 
                   RowBox[{"ToString", "[", "B", "]"}], "<>", 
                   "\"\<\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)\>\""}], ",", 
                  " ", 
                  RowBox[{"\"\< | \[Zeta]=\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"\[Zeta]", "*", "B"}], "]"}], "<>", 
                   "\"\<\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)\>\""}], ",", 
                  RowBox[{"\"\< | C/B=\>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Gamma]oB", "]"}]}]}], " ", 
                 "}"}], ",", 
                RowBox[{"BaseStyle", "->", "\"\<Title\>\""}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "=", 
              RowBox[{"ListPlot", "[", 
               RowBox[{"data", ",", "\[IndentingNewLine]", 
                RowBox[{"Frame", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"True", ",", "True"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FrameLabel", "->", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Dq/eV\>\"", ",", "\"\<E/eV\>\""}], "}"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"FrameStyle", "->", 
                 RowBox[{"Directive", "[", "16", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "->", "1200"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Joined", "->", "False"}], ",", "\[IndentingNewLine]", 
                RowBox[{"PlotStyle", "->", "Automatic"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"positiveOnly", ",", "0", ",", 
                    RowBox[{"-", "Dqrange"}]}], "]"}], ",", "Dqrange"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.1"}], ",", 
                    RowBox[{"Erange", "*", 
                    RowBox[{"evtocm", "/", "B"}], "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotLegends", "->", "multis"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotLabel", "->", "plotLabel"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Epilog", "->", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Thickness", "[", ".005", "]"}], ",", "Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", "0"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "p", "]"}], ",", "p"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Red", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Red", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Erange"}], "}"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Gray", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", "0.025"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", "0.025"}], "}"}]}], 
                    "}"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]}],
                "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p2", "=", 
              RowBox[{"ListPlot", "[", 
               RowBox[{"rdata", ",", 
                RowBox[{"PlotStyle", "->", 
                 RowBox[{"Directive", "[", 
                  RowBox[{
                   RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                   RowBox[{"Opacity", "[", "0.03", "]"}], ",", "Black", ",", 
                   "Dashed"}], "]"}]}], ",", 
                RowBox[{"Joined", "->", "True"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", "None"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Show", "[", 
              RowBox[{"p1", ",", "p2"}], "]"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", "p1", "*)"}], "\[IndentingNewLine]", ")"}], ",", 
           "\[IndentingNewLine]", "\"\<MissingB\>\""}], "\[IndentingNewLine]",
           "]"}]}], "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
       "\"\<MissingA\>\""}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Spacer", "[", "400", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Erange", ",", "2"}], "}"}], ",", "0.1", ",", "5", ",", 
            "0.1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Dqrange", ",", "1"}], "}"}], ",", "0.1", ",", "2", ",", 
            "0.1"}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shell", ",", "\"\<3d\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<3d\>\"", ",", "\"\<4d\>\"", ",", "\"\<5d\>\""}], 
             "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"atom", ",", "\"\<Cu\>\""}], "}"}], ",", 
            RowBox[{"shellToatoms", "[", "shell", "]"}], ",", 
            RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"charge", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
             "}"}], ",", 
            RowBox[{"ControlType", "->", "RadioButton"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vLine", ",", "1"}], "}"}], ",", "0", ",", "6"}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"DqLine", ",", "0.1"}], "}"}], ",", "0", ",", "2"}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"positiveOnly", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}]}], "}"}], ",", 
            RowBox[{"ControlType", "->", "Locator"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", "True"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.855508432876552*^9, 3.85550843760769*^9}, {
   3.855508476524905*^9, 3.855508567768532*^9}, {3.855508599001041*^9, 
   3.8555087517166348`*^9}, {3.8555087897706537`*^9, 
   3.8555090988944073`*^9}, {3.855509154058384*^9, 3.855509156017283*^9}, {
   3.855509190049982*^9, 3.855509205226368*^9}, {3.855509243032156*^9, 
   3.855509245406352*^9}, {3.8555097499335623`*^9, 3.8555097533734283`*^9}, {
   3.8555151481401043`*^9, 3.8555151482620687`*^9}, {3.8555157831126757`*^9, 
   3.855515790028037*^9}, {3.855515867357132*^9, 3.855515885563838*^9}, {
   3.855516256889164*^9, 3.855516281602195*^9}, {3.855516312203457*^9, 
   3.855516317483177*^9}, {3.8555164455602417`*^9, 3.855516521616744*^9}, 
   3.855516552403167*^9, {3.855516641574748*^9, 3.855516646797184*^9}, {
   3.8555167798468313`*^9, 3.855516783097254*^9}, {3.855516868773159*^9, 
   3.8555169372672043`*^9}, {3.855516983615258*^9, 3.8555171480066032`*^9}, {
   3.855517230230496*^9, 3.855517302119215*^9}, {3.855517398412983*^9, 
   3.855517587556814*^9}, {3.855517636993207*^9, 3.855517688553731*^9}, {
   3.85551813669807*^9, 3.8555181422056026`*^9}, 3.8555188219849377`*^9, {
   3.8555803643946037`*^9, 3.855580365107482*^9}, {3.8555805235713253`*^9, 
   3.855580523962031*^9}, {3.855580682425741*^9, 3.855580683638691*^9}, {
   3.855581044179007*^9, 3.8555810752558002`*^9}, {3.8555811643323393`*^9, 
   3.855581262163097*^9}, {3.8555834759230127`*^9, 3.855583596634839*^9}, {
   3.8555838398379183`*^9, 3.855583954075685*^9}, {3.855584011522064*^9, 
   3.855584042556676*^9}, {3.855584076707797*^9, 3.8555840795609627`*^9}, {
   3.855586980333313*^9, 3.8555869834287252`*^9}, {3.8555998728156977`*^9, 
   3.855599873232485*^9}, {3.855599984823764*^9, 3.8556000050806704`*^9}, {
   3.855743723831986*^9, 3.855743725022647*^9}, {3.855849795931859*^9, 
   3.855849845150978*^9}, {3.855849875366624*^9, 3.855849890090774*^9}, {
   3.855849929897633*^9, 3.8558499382250566`*^9}, {3.8559187633166103`*^9, 
   3.855918891887335*^9}, {3.855918962952148*^9, 3.855919023916339*^9}, {
   3.855919062138332*^9, 3.855919132246876*^9}, {3.855926248599987*^9, 
   3.855926253545075*^9}, {3.855926748340851*^9, 3.8559268078901377`*^9}, {
   3.855926935704463*^9, 3.8559270222713413`*^9}, {3.855927086265952*^9, 
   3.8559272501032753`*^9}, {3.855927571989159*^9, 3.855927617207494*^9}, {
   3.855927712172667*^9, 3.855927829623498*^9}, {3.8559278936038923`*^9, 
   3.8559279064634113`*^9}, {3.855927937487803*^9, 3.855927937686706*^9}, {
   3.855927971014614*^9, 3.85592800216201*^9}, {3.855928043922073*^9, 
   3.855928079690524*^9}, {3.855928119655109*^9, 3.855928121288803*^9}, {
   3.855928179391994*^9, 3.855928247168358*^9}, {3.855928277957242*^9, 
   3.8559283030388002`*^9}, {3.8559283839182787`*^9, 3.855928435099793*^9}, {
   3.855928477259296*^9, 3.8559284861759043`*^9}, {3.85592866188365*^9, 
   3.855928845516139*^9}, {3.855928925984083*^9, 3.855929019525465*^9}, {
   3.855929090927648*^9, 3.855929102826084*^9}, {3.8559291344191227`*^9, 
   3.855929231396306*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"b80ff2e0-3749-4e36-ab2a-a09b4c354330"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`atom$$ = "Cr", $CellContext`charge$$ = 
    3, $CellContext`DqLine$$ = 0.1, $CellContext`Dqrange$$ = 
    0.30000000000000004`, $CellContext`Erange$$ = 1.71, $CellContext`p$$ = {
    0.16390000000000002`, 1.6159999999999999`}, $CellContext`positiveOnly$$ = 
    True, $CellContext`shell$$ = "3d", $CellContext`vLine$$ = 1.71, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`Erange$$], 2}, 0.1, 5, 0.1}, {{
       Hold[$CellContext`Dqrange$$], 1}, 0.1, 2, 0.1}, {{
       Hold[$CellContext`shell$$], "3d"}, {"3d", "4d", "5d"}}, {{
       Hold[$CellContext`atom$$], "Cu"}, 
      Dynamic[
       $CellContext`shellToatoms[$CellContext`shell$$]]}, {{
       Hold[$CellContext`charge$$], 4}, {2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`vLine$$], 1}, 0, 6}, {{
       Hold[$CellContext`DqLine$$], 0.1}, 0, 2}, {{
       Hold[$CellContext`positiveOnly$$], True}, {True, False}}, {{
       Hold[$CellContext`p$$], {0.5, 0.5}}}, {
      Hold[
       Row[{
         Spacer[400], 
         Column[{
           Manipulate`Place[1], 
           Manipulate`Place[2]}], 
         Column[{
           Manipulate`Place[3], 
           Manipulate`Place[4], 
           Manipulate`Place[5]}], 
         Column[{
           Manipulate`Place[6], 
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Manipulate`Place[9]}]}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {1246., {402., 406.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`atom$$ = "Cu", $CellContext`charge$$ = 
        4, $CellContext`DqLine$$ = 0.1, $CellContext`Dqrange$$ = 
        1, $CellContext`Erange$$ = 
        2, $CellContext`p$$ = {0.5, 0.5}, $CellContext`positiveOnly$$ = 
        True, $CellContext`shell$$ = "3d", $CellContext`vLine$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`key = {$CellContext`atom$$, \
$CellContext`charge$$}; If[
         MemberQ[
          
          Keys[$CellContext`cowanA], $CellContext`key], $CellContext`\[Gamma] = \
$CellContext`cowanA[$CellContext`key]["C/B"]; $CellContext`B = Round[
            $CellContext`cowanA[$CellContext`key]["B"], 
            1]; $CellContext`\[Zeta] = $CellContext`cowanA[$CellContext`key][
           "\[Zeta]"]; $CellContext`\[Zeta] = \
$CellContext`\[Zeta]/$CellContext`B; $CellContext`\[Gamma]oB = Part[
            Nearest[$CellContext`\[Gamma]soB, $CellContext`\[Gamma]], 
            1]; $CellContext`\[Zeta]oB = Part[
            Nearest[$CellContext`\[Zeta]soB, $CellContext`\[Zeta]], 
            1]; $CellContext`\[Gamma]idx = Part[
             Position[$CellContext`\[Gamma]soB, $CellContext`\[Gamma]oB], 1, 
             1] - 1; $CellContext`\[Zeta]idx = Part[
             Position[$CellContext`\[Zeta]soB, $CellContext`\[Zeta]oB], 1, 1] - 
           1; $CellContext`numElectrons = \
$CellContext`cowanA[$CellContext`key][
           "d^n"]; $CellContext`tskkey = $CellContext`keyTemplate[<|
            "num_electrons" -> $CellContext`numElectrons, 
             "gamma_idx" -> $CellContext`\[Gamma]idx, 
             "zeta_idx" -> $CellContext`\[Zeta]idx|>]; If[
           
           MemberQ[$CellContext`tskkeys, $CellContext`tskkey], \
$CellContext`data = Import[$CellContext`h5fname, $CellContext`tskkey]; If[
             
             KeyExistsQ[$CellContext`allMinima, $CellContext`tskkey], \
$CellContext`minima = $CellContext`allMinima[$CellContext`tskkey]; 
             Null, $CellContext`minima = 
              Map[
               Min, $CellContext`data]; \
$CellContext`allMinima[$CellContext`tskkey] = $CellContext`minima; 
             Null]; $CellContext`data = $CellContext`data - \
$CellContext`minima; $CellContext`data = 
            Transpose[$CellContext`data]; $CellContext`data = 
            Map[Transpose[{$CellContext`DqsoB \
($CellContext`B/$CellContext`evtocm), # \
($CellContext`B/$CellContext`evtocm)}]& , $CellContext`data]; \
$CellContext`rdata = $CellContext`data; $CellContext`xTicks = 
            Table[{($CellContext`ee/$CellContext`B) $CellContext`evtocm \
($CellContext`B/$CellContext`evtocm), $CellContext`ee}, {$CellContext`ee, -
               Round[(6/$CellContext`B) $CellContext`evtocm, 0.1], 
               Round[(6/$CellContext`B) $CellContext`evtocm, 0.1], 
               0.1}]; $CellContext`yTicks = 
            Table[{($CellContext`ee/$CellContext`B) $CellContext`evtocm \
($CellContext`B/$CellContext`evtocm), $CellContext`ee \
($CellContext`B/$CellContext`evtocm)}, {$CellContext`ee, 0, 
               Round[(10/$CellContext`B) $CellContext`evtocm, 0.25], 
               0.25}]; $CellContext`tdata = 
            Transpose[$CellContext`data]; $CellContext`multidata = <||>; \
$CellContext`multidata = 
            Table[$CellContext`Dq = 
               Part[$CellContext`datum, 1, 1]; $CellContext`eivals = Chop[
                 Map[Last, $CellContext`datum]]; $CellContext`eivals = 
               Round[$CellContext`eivals, 
                 0.001]; $CellContext`uniqueEigenvals = 
               DeleteDuplicates[$CellContext`eivals]; 
              Table[{$CellContext`Dq, $CellContext`eival, 
                 
                 Count[$CellContext`eivals, $CellContext`eival]}, \
{$CellContext`eival, $CellContext`uniqueEigenvals}], {$CellContext`datum, \
$CellContext`tdata}]; $CellContext`multidata = 
            Flatten[$CellContext`multidata, 1]; $CellContext`multis = Sort[
              DeleteDuplicates[
               Map[Last, $CellContext`multidata]]]; $CellContext`data = 
            Table[
              Map[{
                Part[#, 1], 
                Part[#, 2]}& , 
               
               Select[$CellContext`multidata, 
                Part[#, 
                  3] == $CellContext`count& ]], {$CellContext`count, \
$CellContext`multis}]; {$CellContext`\[Gamma]oB, $CellContext`\[Zeta]oB}; \
$CellContext`plotLabel = Row[{
               
               Superscript[$CellContext`atom$$, 
                ToString[$CellContext`charge$$] <> "+"], " | ", 
               Superscript[$CellContext`shell$$, $CellContext`numElectrons], 
               " | B=" <> ToString[$CellContext`B] <> 
               "\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)", " | \[Zeta]=" <> 
               ToString[$CellContext`\[Zeta] $CellContext`B] <> 
               "\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)", " | C/B=" <> 
               ToString[$CellContext`\[Gamma]oB]}, BaseStyle -> 
              "Title"]; $CellContext`p1 = 
            ListPlot[$CellContext`data, Frame -> {{True, True}, {True, True}},
               FrameLabel -> {"Dq/eV", "E/eV"}, FrameStyle -> Directive[16], 
              ImageSize -> 1200, Joined -> False, PlotStyle -> Automatic, 
              PlotRange -> {{
                 
                 If[$CellContext`positiveOnly$$, 
                  0, -$CellContext`Dqrange$$], $CellContext`Dqrange$$}, \
{-0.1, $CellContext`Erange$$ ($CellContext`evtocm/$CellContext`B) \
($CellContext`B/$CellContext`evtocm)}}, PlotLegends -> $CellContext`multis, 
              PlotLabel -> $CellContext`plotLabel, Epilog -> {
                Tooltip[
                 Point[$CellContext`p$$], $CellContext`p$$], {Red, Dashed, 
                 Line[{{(-6) ($CellContext`B/$CellContext`evtocm), 
                    Part[$CellContext`p$$, 2]}, {
                   6 ($CellContext`B/$CellContext`evtocm), 
                    Part[$CellContext`p$$, 2]}}]}, {Red, Dashed, 
                 Line[{{
                    Part[$CellContext`p$$, 1], 0}, {
                    Part[$CellContext`p$$, 1], $CellContext`Erange$$}}]}, {
                Gray, Dashed, 
                 
                 Line[{{(-6) ($CellContext`B/$CellContext`evtocm), 0.025}, {
                   6 ($CellContext`B/$CellContext`evtocm), 
                    0.025}}]}}]; $CellContext`p2 = 
            ListPlot[$CellContext`rdata, PlotStyle -> Directive[
                Thickness[0.001], 
                Opacity[0.03], Black, Dashed], Joined -> True, PlotLegends -> 
              None]; Show[$CellContext`p1, $CellContext`p2], "MissingB"], 
         "MissingA"]), 
      "Specifications" :> {{{$CellContext`Erange$$, 2}, 0.1, 5, 0.1, 
         ControlPlacement -> 1}, {{$CellContext`Dqrange$$, 1}, 0.1, 2, 0.1, 
         ControlPlacement -> 2}, {{$CellContext`shell$$, "3d"}, {
         "3d", "4d", "5d"}, ControlPlacement -> 
         3}, {{$CellContext`atom$$, "Cu"}, 
         Dynamic[
          $CellContext`shellToatoms[$CellContext`shell$$]], ControlType -> 
         SetterBar, ControlPlacement -> 4}, {{$CellContext`charge$$, 4}, {2, 
         3, 4, 5, 6, 7}, ControlType -> RadioButton, ControlPlacement -> 
         5}, {{$CellContext`vLine$$, 1}, 0, 6, ControlPlacement -> 
         6}, {{$CellContext`DqLine$$, 0.1}, 0, 2, ControlPlacement -> 
         7}, {{$CellContext`positiveOnly$$, True}, {True, False}, 
         ControlPlacement -> 8}, {{$CellContext`p$$, {0.5, 0.5}}, ControlType -> 
         Locator, ControlPlacement -> 9}, 
        Row[{
          Spacer[400], 
          Column[{
            Manipulate`Place[1], 
            Manipulate`Place[2]}], 
          Column[{
            Manipulate`Place[3], 
            Manipulate`Place[4], 
            Manipulate`Place[5]}], 
          Column[{
            Manipulate`Place[6], 
            Manipulate`Place[7], 
            Manipulate`Place[8], 
            Manipulate`Place[9]}]}]}, "Options" :> {TrackedSymbols :> True}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1296., {497., 503.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.855926938989921*^9, 3.855927022592304*^9}, {
   3.855927089009617*^9, 3.855927119703845*^9}, {3.855927158206127*^9, 
   3.855927250496642*^9}, {3.8559275858108273`*^9, 3.85592761748792*^9}, {
   3.8559277160092163`*^9, 3.855927732283804*^9}, {3.855927766733674*^9, 
   3.855927838923727*^9}, {3.855927879836439*^9, 3.8559279066554613`*^9}, 
   3.855927938002762*^9, {3.855927973665629*^9, 3.855928002754796*^9}, {
   3.855928056933653*^9, 3.855928080441444*^9}, 3.855928121847896*^9, 
   3.855928181666087*^9, {3.855928219701548*^9, 3.855928247749906*^9}, {
   3.855928292611209*^9, 3.855928303517149*^9}, {3.8559284031387243`*^9, 
   3.855928486419722*^9}, {3.855928673473721*^9, 3.8559286881906137`*^9}, {
   3.855928718821267*^9, 3.855928740957872*^9}, {3.855928774596549*^9, 
   3.8559288466264133`*^9}, {3.855928951128571*^9, 3.85592897802647*^9}, 
   3.855929021109371*^9, {3.855929093689068*^9, 3.8559291030999527`*^9}, 
   3.855929142997982*^9, {3.8559291847536907`*^9, 3.8559292316209707`*^9}, {
   3.855929338414249*^9, 3.855929341877141*^9}, 3.856001268983738*^9, 
   3.857486099301744*^9, {3.857486160444345*^9, 3.8574861681101637`*^9}, 
   3.8574862143928127`*^9},ExpressionUUID->"20e0109f-5683-46c5-81ae-\
be01728856b1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Multiplicity", "Subsection",
 CellChangeTimes->{{3.856001318063246*^9, 
  3.856001338003768*^9}},ExpressionUUID->"6960c893-e9af-4dc5-a5af-\
7d963dce2bb4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allMinima", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", "=", 
      RowBox[{"{", 
       RowBox[{"atom", ",", "charge"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "cowanA", "]"}], ",", "key"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<C/B\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"B", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<B\>\"", "]"}], 
            ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<\[Zeta]\>\"", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]", "=", 
          RowBox[{"\[Zeta]", "/", "B"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]oB", "=", 
          RowBox[{
           RowBox[{"Nearest", "[", 
            RowBox[{"\[Gamma]soB", ",", "\[Gamma]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]oB", "=", 
          RowBox[{
           RowBox[{"Nearest", "[", 
            RowBox[{"\[Zeta]soB", ",", "\[Zeta]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]idx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Gamma]soB", ",", "\[Gamma]oB"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Zeta]idx", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Zeta]soB", ",", "\[Zeta]oB"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numElectrons", "=", 
          RowBox[{
           RowBox[{"cowanA", "[", "key", "]"}], "[", "\"\<d^n\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tskkey", "=", 
          RowBox[{"keyTemplate", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<num_electrons\>\"", "->", "numElectrons"}], ",", 
             RowBox[{"\"\<gamma_idx\>\"", "->", "\[Gamma]idx"}], ",", 
             RowBox[{"\"\<zeta_idx\>\"", "->", "\[Zeta]idx"}]}], "|>"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"tskkeys", ",", "tskkey"}], "]"}], ",", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"data", "=", 
              RowBox[{"Import", "[", 
               RowBox[{"h5fname", ",", "tskkey"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"allMinima", ",", "tskkey"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"minima", "=", 
                 RowBox[{"allMinima", "[", "tskkey", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"minima", "=", 
                  RowBox[{"Min", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"allMinima", "[", "tskkey", "]"}], "=", "minima"}], 
                 ";"}], ")"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"data", "-", "minima"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{"Transpose", "[", "data", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"data", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"DqsoB", "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                   RowBox[{"#", "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}], "]"}], "&"}], "/@",
                "data"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"xTicks", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ee", "/", "B"}], "*", "evtocm", "*", 
                   FractionBox["B", "evtocm"]}], ",", "ee"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ee", ",", 
                  RowBox[{"-", 
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"6", "/", "B"}], "*", "evtocm"}], ",", "0.1"}], 
                    "]"}]}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"6", "/", "B"}], "*", "evtocm"}], ",", "0.1"}], 
                   "]"}], ",", "0.1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"yTicks", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ee", "/", "B"}], "*", "evtocm", "*", 
                   FractionBox["B", "evtocm"]}], ",", 
                  RowBox[{"ee", "*", 
                   FractionBox["B", "evtocm"]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ee", ",", "0", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"10", "/", "B"}], "*", "evtocm"}], ",", "0.25"}], 
                   "]"}], ",", "0.25"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]oB", ",", "\[Zeta]oB"}], "}"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"plotLabel", "=", 
              RowBox[{"Row", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Superscript", "[", 
                   RowBox[{"atom", ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", "charge", "]"}], "<>", 
                    "\"\<+\>\""}]}], "]"}], ",", "\"\< | \>\"", ",", 
                  RowBox[{"Superscript", "[", 
                   RowBox[{"shell", ",", "numElectrons"}], "]"}], ",", 
                  RowBox[{"\"\< | B=\>\"", "<>", 
                   RowBox[{"ToString", "[", "B", "]"}], "<>", 
                   "\"\<\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)\>\""}], ",", 
                  " ", 
                  RowBox[{"\"\< | \[Zeta]=\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"\[Zeta]", "*", "B"}], "]"}], "<>", 
                   "\"\<\!\(\*SuperscriptBox[\(cm\), \(-1\)]\)\>\""}], ",", 
                  RowBox[{"\"\< | C/B=\>\"", "<>", 
                   RowBox[{"ToString", "[", "\[Gamma]oB", "]"}]}]}], " ", 
                 "}"}], ",", 
                RowBox[{"BaseStyle", "->", "\"\<Title\>\""}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{"data", ",", "\[IndentingNewLine]", 
               RowBox[{"Frame", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"True", ",", "True"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameLabel", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<Dq/eV\>\"", ",", "\"\<E/eV\>\""}], "}"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"FrameStyle", "->", 
                RowBox[{"Directive", "[", "16", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "->", "1200"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "->", "joined"}], ",", "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Thick", ",", "Blue"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"FrameTicks", "->", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"yTicks", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xTicks", ",", "None"}], "}"}]}], "}"}]}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "Dqrange"}], ",", "Dqrange"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Erange", "*", 
                    RowBox[{"evtocm", "/", "B"}], "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotLabel", "->", "plotLabel"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Epilog", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Thickness", "[", ".005", "]"}], ",", "Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", "0"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Red", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                    RowBox[{"vLine", "*", 
                    FractionBox["evtocm", "B"], "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", 
                    RowBox[{"vLine", "*", 
                    FractionBox["evtocm", "B"], "*", 
                    FractionBox["B", "evtocm"]}]}], "}"}]}], "}"}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Red", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"DqLine", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"DqLine", ",", "Erange"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Gray", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], "*", 
                    FractionBox["B", "evtocm"]}], ",", "0.025"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"6", "*", 
                    FractionBox["B", "evtocm"]}], ",", "0.025"}], "}"}]}], 
                    "}"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]}],
               "\[IndentingNewLine]", "]"}]}], ")"}], ",", 
           "\[IndentingNewLine]", "\"\<MissingB\>\""}], "\[IndentingNewLine]",
           "]"}]}], "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
       "\"\<MissingA\>\""}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Spacer", "[", "400", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Erange", ",", "2"}], "}"}], ",", "0.1", ",", "5", ",", 
            "0.1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Dqrange", ",", "1"}], "}"}], ",", "0.1", ",", "2", ",", 
            "0.1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"joined", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shell", ",", "\"\<3d\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<3d\>\"", ",", "\"\<4d\>\"", ",", "\"\<5d\>\""}], 
             "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"atom", ",", "\"\<Cu\>\""}], "}"}], ",", 
            RowBox[{"shellToatoms", "[", "shell", "]"}], ",", 
            RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"charge", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
             "}"}], ",", 
            RowBox[{"ControlType", "->", "RadioButton"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vLine", ",", "1"}], "}"}], ",", "0", ",", "6"}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"DqLine", ",", "0.1"}], "}"}], ",", "0", ",", "2"}], 
           "}"}], "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", "True"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.855508432876552*^9, 3.85550843760769*^9}, {
   3.855508476524905*^9, 3.855508567768532*^9}, {3.855508599001041*^9, 
   3.8555087517166348`*^9}, {3.8555087897706537`*^9, 
   3.8555090988944073`*^9}, {3.855509154058384*^9, 3.855509156017283*^9}, {
   3.855509190049982*^9, 3.855509205226368*^9}, {3.855509243032156*^9, 
   3.855509245406352*^9}, {3.8555097499335623`*^9, 3.8555097533734283`*^9}, {
   3.8555151481401043`*^9, 3.8555151482620687`*^9}, {3.8555157831126757`*^9, 
   3.855515790028037*^9}, {3.855515867357132*^9, 3.855515885563838*^9}, {
   3.855516256889164*^9, 3.855516281602195*^9}, {3.855516312203457*^9, 
   3.855516317483177*^9}, {3.8555164455602417`*^9, 3.855516521616744*^9}, 
   3.855516552403167*^9, {3.855516641574748*^9, 3.855516646797184*^9}, {
   3.8555167798468313`*^9, 3.855516783097254*^9}, {3.855516868773159*^9, 
   3.8555169372672043`*^9}, {3.855516983615258*^9, 3.8555171480066032`*^9}, {
   3.855517230230496*^9, 3.855517302119215*^9}, {3.855517398412983*^9, 
   3.855517587556814*^9}, {3.855517636993207*^9, 3.855517688553731*^9}, {
   3.85551813669807*^9, 3.8555181422056026`*^9}, 3.8555188219849377`*^9, {
   3.8555803643946037`*^9, 3.855580365107482*^9}, {3.8555805235713253`*^9, 
   3.855580523962031*^9}, {3.855580682425741*^9, 3.855580683638691*^9}, {
   3.855581044179007*^9, 3.8555810752558002`*^9}, {3.8555811643323393`*^9, 
   3.855581262163097*^9}, {3.8555834759230127`*^9, 3.855583596634839*^9}, {
   3.8555838398379183`*^9, 3.855583954075685*^9}, {3.855584011522064*^9, 
   3.855584042556676*^9}, {3.855584076707797*^9, 3.8555840795609627`*^9}, {
   3.855586980333313*^9, 3.8555869834287252`*^9}, {3.8555998728156977`*^9, 
   3.855599873232485*^9}, {3.855599984823764*^9, 3.8556000050806704`*^9}, {
   3.855743723831986*^9, 3.855743725022647*^9}, {3.855849795931859*^9, 
   3.855849845150978*^9}, {3.855849875366624*^9, 3.855849890090774*^9}, {
   3.855849929897633*^9, 3.8558499382250566`*^9}, {3.8559187633166103`*^9, 
   3.855918891887335*^9}, {3.855918962952148*^9, 3.855919023916339*^9}, {
   3.855919062138332*^9, 3.855919132246876*^9}, {3.855926248599987*^9, 
   3.855926253545075*^9}, {3.855926748340851*^9, 3.8559268078901377`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"fc2c4544-9312-4c39-9cad-1832d466c785"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1516, 1027},
WindowMargins->{{Automatic, 10}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ceb18faf-2f6c-4010-b61c-7cb3f93e4780"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 304, 6, 160, "Title",ExpressionUUID->"c79aa525-ceb9-4d2a-afbf-c1054b810dc9"],
Cell[887, 30, 197, 2, 35, "Text",ExpressionUUID->"62bfb0f1-861d-435a-9a3e-080963a2cdf2"],
Cell[CellGroupData[{
Cell[1109, 36, 155, 3, 67, "Section",ExpressionUUID->"e6684225-0fee-479e-8f3f-965e2d5c5f54"],
Cell[1267, 41, 4869, 126, 530, "Input",ExpressionUUID->"655ccd46-a513-469a-aa0a-cb3e9a034e4d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6173, 172, 217, 4, 67, "Section",ExpressionUUID->"5cde32bc-e3da-4aa9-bf5b-2537a5eeed37"],
Cell[6393, 178, 344, 7, 35, "Text",ExpressionUUID->"8331797c-55c7-4105-a737-c515f29b041e"],
Cell[CellGroupData[{
Cell[6762, 189, 169, 3, 54, "Subsection",ExpressionUUID->"40c981f6-fca6-4325-99ac-84fee0b59c3c"],
Cell[6934, 194, 5875, 138, 619, "Input",ExpressionUUID->"db8a4c65-2f26-42ca-a132-4d17503ca3bc"]
}, Closed]],
Cell[CellGroupData[{
Cell[12846, 337, 167, 3, 38, "Subsection",ExpressionUUID->"e09b2eaa-bc00-427e-8879-12c33293c24b"],
Cell[13016, 342, 357, 9, 30, "Input",ExpressionUUID->"55ea2be0-835e-43d3-8b36-51d893f097c5"],
Cell[CellGroupData[{
Cell[13398, 355, 9416, 221, 934, "Input",ExpressionUUID->"e2d4f54f-be54-4725-a945-1a4ba8601310"],
Cell[22817, 578, 5791, 112, 991, "Output",ExpressionUUID->"e6e8071d-0c8d-433f-986e-1fdbb0a40fe5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28645, 695, 296, 7, 30, "Input",ExpressionUUID->"6c7f6544-8a56-46ef-9675-10721c4b496f"],
Cell[28944, 704, 180, 3, 34, "Output",ExpressionUUID->"b9cc60a3-0d03-46b9-8e1f-a19e9c701213"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29161, 712, 128, 3, 30, "Input",ExpressionUUID->"980b4527-2d0a-4e37-bc1c-ce92813fb509"],
Cell[29292, 717, 486, 10, 34, "Output",ExpressionUUID->"91eb6a59-c715-40ba-b6f3-36a659b34e4b"]
}, Open  ]],
Cell[29793, 730, 7874, 189, 808, "Input",ExpressionUUID->"f33e0381-4b84-4b6f-8061-45aae966ef07"],
Cell[37670, 921, 187, 4, 30, "Input",ExpressionUUID->"81bcfc0b-11e2-4c53-964a-ace18327ca3b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37906, 931, 256, 4, 53, "Section",ExpressionUUID->"51a2af69-5072-4a10-bf6a-0fc30f940320"],
Cell[38165, 937, 487, 9, 35, "Text",ExpressionUUID->"a20f7dde-bbf0-456d-b702-205e15b93468"],
Cell[CellGroupData[{
Cell[38677, 950, 167, 3, 54, "Subsection",ExpressionUUID->"f196ee70-23ea-412e-aca3-6478433e530f"],
Cell[CellGroupData[{
Cell[38869, 957, 23933, 517, 2226, "Input",ExpressionUUID->"b80ff2e0-3749-4e36-ab2a-a09b4c354330"],
Cell[62805, 1476, 11798, 226, 1019, "Output",ExpressionUUID->"20e0109f-5683-46c5-81ae-be01728856b1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74652, 1708, 168, 3, 54, "Subsection",ExpressionUUID->"6960c893-e9af-4dc5-a5af-7d963dce2bb4"],
Cell[74823, 1713, 18563, 408, 1764, "Input",ExpressionUUID->"fc2c4544-9312-4c39-9cad-1832d466c785"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

